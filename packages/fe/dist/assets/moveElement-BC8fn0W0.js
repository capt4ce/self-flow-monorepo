import{R as F,n as e,r as g}from"./vendor-react-tYkQlTQi.js";import{d as L,L as E,I as C,B as I,u as _,D as q,a as X,b as J,c as Z,f as O}from"./index-B2yiPlNq.js";import{P as ee,C as Q,S as $,e as z,f as B,g as R,h as v,R as se,B as S,i as K,j as H,t as oe,u as le}from"./TaskDialog-DECGOoM7.js";import{b4 as ae}from"./vendor-DNP07iVI.js";import{h as re,f as U,P as ne,k as ie,e as te}from"./vendor-date-charts-B43nfnO2.js";const me=({label:l,onTasksSelected:x})=>{const[o,f]=F.useState(""),[m]=ae(o,300),[u,h]=F.useState([]),[d,k]=F.useState([]),[w,y]=F.useState(!1),r=F.useCallback(async n=>{try{y(!0);const c=await L.tasks.search(n,{isTemplate:!0,statusEquals:["todo","in progress","blocked"]});h(c.data)}catch(c){console.error("Error fetching available tasks:",c),h([])}finally{y(!1)}},[]);F.useEffect(()=>{r(m)},[m,r]),F.useEffect(()=>{r("")},[r]);const p=n=>{k(c=>c.find(D=>D.id===n.id)?c.filter(D=>D.id!==n.id):[...c,n])},b=()=>{x(d),k([]),h([]),f(""),r("")};return e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(E,{children:l},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskAutocomplete.tsx",lineNumber:71,columnNumber:7},void 0),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(re,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskAutocomplete.tsx",lineNumber:73,columnNumber:9},void 0),e.jsxDEV(C,{placeholder:"Search for a task to duplicate...",value:o,onChange:n=>f(n.target.value),className:"pl-10"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskAutocomplete.tsx",lineNumber:74,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskAutocomplete.tsx",lineNumber:72,columnNumber:7},void 0),e.jsxDEV("div",{className:"max-h-40 overflow-y-auto space-y-1 border-t",children:[w&&e.jsxDEV(ee,{className:"w-full"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskAutocomplete.tsx",lineNumber:82,columnNumber:25},void 0),!w&&u.length>0&&e.jsxDEV("div",{className:"border rounded-md",children:u.map(n=>e.jsxDEV("div",{className:"flex items-center space-x-2 p-2 hover:bg-gray-100",children:[e.jsxDEV(Q,{checked:d.some(c=>c.id===n.id),onCheckedChange:()=>p(n)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskAutocomplete.tsx",lineNumber:90,columnNumber:17},void 0),e.jsxDEV("span",{className:"text-sm font-medium",children:n.title},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskAutocomplete.tsx",lineNumber:94,columnNumber:17},void 0)]},n.id,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskAutocomplete.tsx",lineNumber:86,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskAutocomplete.tsx",lineNumber:84,columnNumber:11},void 0),!w&&u.length===0&&o&&e.jsxDEV("p",{className:"text-sm text-muted-foreground p-2",children:"No tasks found."},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskAutocomplete.tsx",lineNumber:100,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskAutocomplete.tsx",lineNumber:81,columnNumber:7},void 0),d.length>0&&e.jsxDEV(I,{onClick:b,className:"w-full",children:["Add ",d.length," selected task(s)"]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskAutocomplete.tsx",lineNumber:104,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskAutocomplete.tsx",lineNumber:70,columnNumber:5},void 0)},Ne=({open:l,onOpenChange:x,goal:o,onSaved:f,initialDate:m,initialTitle:u})=>{const h=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/,d=s=>Array.from(new Set(s.filter(a=>typeof a=="string"&&h.test(a)))),k=!!(o!=null&&o.id),{user:w}=_(),y=m||new Date,[r,p]=g.useState({title:u||"",description:"",category:"Daily",status:"active",startDate:U(y,"yyyy-MM-dd"),endDate:U(y,"yyyy-MM-dd")}),[b,n]=g.useState([]),[c,D]=g.useState([]),[N,V]=g.useState(!1),[G,A]=g.useState([]),T=()=>{const s=m||new Date;p({title:u||"",description:"",category:"Daily",status:"active",startDate:U(s,"yyyy-MM-dd"),endDate:U(s,"yyyy-MM-dd")}),n([]),D([]),A([])};g.useEffect(()=>{o?(p({title:o.title||"",description:o.description||"",category:o.category||"Daily",status:o.status||"active",startDate:o.startDate?U(new Date(o.startDate),"yyyy-MM-dd"):U(new Date,"yyyy-MM-dd"),endDate:o.endDate?U(new Date(o.endDate),"yyyy-MM-dd"):U(new Date,"yyyy-MM-dd")}),A(o.tasks||[]),D(d((o.tasks||[]).map(s=>s.id)))):T()},[o,m,u]);const M=async()=>{if(!(r.title.trim()===""||!w)){V(!0);try{const s={title:r.title,description:r.description||void 0,category:r.category,status:r.status,startDate:r.startDate||void 0,endDate:r.endDate||void 0};if(o!=null&&o.id){const a=b.filter(j=>j.title.trim()!==""),i=d(c),t=d(G.map(j=>j.id));await L.goals.update(o.id,{...s,newTasks:a.length>0?a.map(j=>({title:j.title,description:j.description||void 0,effort:j.effort||void 0,status:j.status||"todo",templateId:j.templateId||void 0})):void 0,selectedTaskIds:i.length?i:void 0,currentTaskIds:t.length?t:void 0})}else{const a=b.filter(t=>t.title.trim()!==""),i=d(c);await L.goals.create({...s,newTasks:a.length>0?a.map(t=>({title:t.title,description:t.description||void 0,effort:t.effort||void 0,status:t.status||"todo",templateId:t.templateId||void 0})):void 0,existingTaskIds:i.length>0?i:void 0})}T(),x(!1),f()}catch(s){console.error("Error saving goal:",s)}finally{V(!1)}}},P=async()=>{r.title.trim()!==""&&await M()},Y=s=>{(s.metaKey||s.ctrlKey)&&s.key==="Enter"&&(s.preventDefault(),P())};return e.jsxDEV(q,{open:l,onOpenChange:x,children:e.jsxDEV(X,{onKeyDown:Y,className:"max-w-4xl max-h-[90vh] overflow-y-auto w-[95vw] sm:w-full",children:[e.jsxDEV(J,{children:e.jsxDEV(Z,{className:"text-lg sm:text-xl",children:k?"Edit Goal":"Create New Goal"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:216,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:215,columnNumber:9},void 0),e.jsxDEV("div",{className:"space-y-4 sm:space-y-6 py-4",children:[e.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(E,{htmlFor:"goal-title",className:"text-sm sm:text-base",children:"Title"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:223,columnNumber:15},void 0),e.jsxDEV(C,{id:"goal-title",value:r.title,onChange:s=>p(a=>({...a,title:s.target.value})),placeholder:"Enter goal title"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:224,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:222,columnNumber:13},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(E,{htmlFor:"goal-category",className:"text-sm sm:text-base",children:"Category"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:237,columnNumber:15},void 0),e.jsxDEV($,{value:r.category,onValueChange:s=>p(a=>({...a,category:s})),children:[e.jsxDEV(z,{children:e.jsxDEV(B,{},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:248,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:247,columnNumber:17},void 0),e.jsxDEV(R,{children:[e.jsxDEV(v,{value:"Main",children:"Main"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:251,columnNumber:19},void 0),e.jsxDEV(v,{value:"Yearly",children:"Yearly"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:252,columnNumber:19},void 0),e.jsxDEV(v,{value:"Quarterly",children:"Quarterly"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:253,columnNumber:19},void 0),e.jsxDEV(v,{value:"Monthly",children:"Monthly"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:254,columnNumber:19},void 0),e.jsxDEV(v,{value:"Weekly",children:"Weekly"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:255,columnNumber:19},void 0),e.jsxDEV(v,{value:"Daily",children:"Daily"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:256,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:250,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:238,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:236,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:221,columnNumber:11},void 0),e.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(E,{htmlFor:"goal-status",className:"text-sm sm:text-base",children:"Status"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:264,columnNumber:15},void 0),e.jsxDEV($,{value:r.status,onValueChange:s=>p(a=>({...a,status:s})),children:[e.jsxDEV(z,{children:e.jsxDEV(B,{placeholder:"Select status"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:275,columnNumber:19},void 0)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:274,columnNumber:17},void 0),e.jsxDEV(R,{children:[e.jsxDEV(v,{value:"active",children:"Active"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:278,columnNumber:19},void 0),e.jsxDEV(v,{value:"done",children:"Done"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:279,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:277,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:265,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:263,columnNumber:13},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(E,{htmlFor:"goal-start-date",className:"text-sm sm:text-base",children:"Start Date"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:284,columnNumber:15},void 0),e.jsxDEV(C,{id:"goal-start-date",type:"date",value:r.startDate,onChange:s=>p(a=>({...a,startDate:s.target.value}))},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:285,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:283,columnNumber:13},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(E,{htmlFor:"goal-end-date",className:"text-sm sm:text-base",children:"End Date"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:298,columnNumber:15},void 0),e.jsxDEV(C,{id:"goal-end-date",type:"date",value:r.endDate,onChange:s=>p(a=>({...a,endDate:s.target.value}))},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:299,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:297,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:262,columnNumber:11},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(E,{htmlFor:"goal-description",children:"Description"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:314,columnNumber:13},void 0),e.jsxDEV(se,{value:r.description,onChange:s=>p(a=>({...a,description:s}))},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:315,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:313,columnNumber:11},void 0),o&&G.length>0&&e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(E,{children:"Current Tasks in this Goal"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:326,columnNumber:15},void 0),e.jsxDEV("div",{className:"max-h-40 overflow-y-auto space-y-2 border rounded p-3",children:G.map(s=>e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV(Q,{checked:c.includes(s.id),onCheckedChange:a=>{D(a?i=>[...i,s.id]:i=>i.filter(t=>t!==s.id))}},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:330,columnNumber:21},void 0),e.jsxDEV("span",{className:`flex-1 text-sm cursor-pointer hover:text-blue-600 ${s.completed?"line-through text-gray-500":""} ${s.status==="not done"?"line-through text-red-500":""}`,children:s.title},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:345,columnNumber:21},void 0),e.jsxDEV("div",{className:"flex gap-1",children:[s.status&&e.jsxDEV(S,{className:`text-xs ${K(s.status)}`,children:s.status},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:358,columnNumber:25},void 0),s.effort&&e.jsxDEV(S,{className:`text-xs ${H(s.effort)}`,children:s.effort},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:367,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:356,columnNumber:21},void 0)]},s.id,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:329,columnNumber:19},void 0))},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:327,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:"Uncheck tasks to remove them from this goal"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:379,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:325,columnNumber:13},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(E,{className:"text-sm sm:text-base",children:"Quick Add Tasks"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:387,columnNumber:13},void 0),e.jsxDEV("div",{className:"p-2 border rounded-lg",children:[e.jsxDEV(me,{label:"Duplicate Task from Template",onTasksSelected:s=>{const a=s.map(i=>({title:i.title,description:i.description||"",effort:i.effort||void 0,status:"todo",templateId:i.id}));n(i=>[...i,...a])}},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:389,columnNumber:15},void 0),e.jsxDEV("div",{className:"space-y-2 mt-2",children:[b.map((s,a)=>e.jsxDEV("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center p-2 border rounded",children:[e.jsxDEV(C,{placeholder:"Task title",value:s.title,onChange:i=>{const t=[...b];t[a].title=i.target.value,n(t)},className:"flex-1"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:408,columnNumber:21},void 0),e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV($,{value:s.effort||"",onValueChange:i=>{const t=[...b];t[a].effort=i,n(t)},children:[e.jsxDEV(z,{className:"w-full sm:w-20",children:e.jsxDEV(B,{placeholder:"Effort"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:428,columnNumber:27},void 0)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:427,columnNumber:25},void 0),e.jsxDEV(R,{children:[e.jsxDEV(v,{value:"low",children:"Low"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:431,columnNumber:27},void 0),e.jsxDEV(v,{value:"med",children:"Med"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:432,columnNumber:27},void 0),e.jsxDEV(v,{value:"high",children:"High"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:433,columnNumber:27},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:430,columnNumber:25},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:419,columnNumber:23},void 0),e.jsxDEV(I,{variant:"ghost",size:"sm",className:"flex-shrink-0",onClick:()=>{const i=b.filter((t,j)=>j!==a);n(i)},children:"Ã—"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:436,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:418,columnNumber:21},void 0)]},a,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:404,columnNumber:19},void 0)),e.jsxDEV(I,{variant:"outline",size:"sm",onClick:()=>n([...b,{title:"",description:"",status:"todo"}]),className:"w-full sm:w-auto",children:[e.jsxDEV(ne,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:461,columnNumber:19},void 0),"Add Task"]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:450,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:402,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:388,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:386,columnNumber:11},void 0),e.jsxDEV(oe,{label:"Add Existing Tasks",selectedExistingTaskIds:c,setSelectedExistingTaskIds:D},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:468,columnNumber:11},void 0),e.jsxDEV(I,{onClick:P,className:"w-full",disabled:N,children:N?"Saving...":k?"Update Goal":"Create Goal"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:474,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:220,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:211,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/dialogs/GoalFormDialog.tsx",lineNumber:210,columnNumber:5},void 0)},W=({task:l,level:x=0,hiddenInfos:o=[],onEditTask:f,onStatusChange:m})=>{const[u,h]=g.useState(l.completed||["completed","not done"].includes(l.status||"")),[d,k]=g.useState(l.status??null);g.useEffect(()=>{h(l.completed||["completed","not done"].includes(l.status||"")),k(l.status??null)},[l.completed,l.status]);const{subtasks:w,fetchTaskSubtasks:y}=O(),[r,p]=g.useState(!1),b=g.useCallback(()=>{if(!l.id){console.error("Cannot expand task without ID");return}p(!r),y(l.id)},[p,r,y,l]),n=l.subtaskCount&&l.subtaskCount>0,c=(w==null?void 0:w[l.id])||[],D=async(N,V)=>{if(!N.id){console.error("Cannot toggle task without ID");return}const G=d??"todo",A=u,T=V?"completed":"todo";h(V),k(T),m==null||m(N.id,T,V);try{await L.tasks.update(N.id,{completed:V,status:T})}catch(M){console.error("Error toggling task completion:",M),h(A),k(G),m==null||m(N.id,G,A)}};return e.jsxDEV("div",{className:`${x>0?"ml-4 sm:ml-6":""}`,children:[e.jsxDEV("div",{className:"flex items-start sm:items-center gap-2 p-2 border rounded hover:bg-gray-50",children:[e.jsxDEV("div",{className:"flex items-center gap-1 flex-shrink-0",children:!!n&&e.jsxDEV("button",{onClick:b,className:"p-0.5 hover:bg-gray-200 rounded",children:r?e.jsxDEV(ie,{size:14},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:99,columnNumber:17},void 0):e.jsxDEV(te,{size:14},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:101,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:94,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:92,columnNumber:9},void 0),!o.includes("check")&&e.jsxDEV(Q,{checked:u,onCheckedChange:N=>D(l,!!N),className:"flex-shrink-0 mt-0.5 sm:mt-0"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:107,columnNumber:11},void 0),e.jsxDEV("span",{className:`flex-1 min-w-0 text-xs sm:text-sm cursor-pointer hover:text-blue-600 break-words ${u?"line-through text-gray-500":""} ${d==="not done"?"line-through text-red-500":""}`,onClick:()=>f==null?void 0:f(l),children:l.title},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:113,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex flex-wrap gap-1 flex-shrink-0",children:[l.isTemplate&&e.jsxDEV(S,{className:"text-[10px] sm:text-xs",children:"Template"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:123,columnNumber:13},void 0),!o.includes("status")&&d&&e.jsxDEV(S,{className:`text-[10px] sm:text-xs ${K(d)}`,children:d},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:126,columnNumber:13},void 0),!o.includes("effort")&&l.effort&&e.jsxDEV(S,{className:`text-[10px] sm:text-xs ${H(l.effort)}`,children:l.effort},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:135,columnNumber:13},void 0),!o.includes("priority")&&l.priority&&e.jsxDEV(S,{className:`text-[10px] sm:text-xs ${le(l.priority)}`,children:l.priority},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:142,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:121,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:91,columnNumber:7},void 0),r&&n&&e.jsxDEV("div",{className:"mt-1",children:c.map(N=>e.jsxDEV(W,{task:N,level:x+1,onEditTask:f,onStatusChange:m},N.id,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:153,columnNumber:13},void 0))},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:151,columnNumber:9},void 0)]},l.id,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/components/common/TaskListItem.tsx",lineNumber:90,columnNumber:5},void 0)},ge=g.memo(W);function xe(l,x,o){const f=[...l],m=f.length;if(x<0||x>=m||o<0||o>=m)throw new Error("Index out of bounds");const[u]=f.splice(x,1);return f.splice(o,0,u),f}export{Ne as G,ge as T,xe as m};
