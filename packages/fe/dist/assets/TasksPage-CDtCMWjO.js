import{r as l,n as e}from"./vendor-react-tYkQlTQi.js";import{C as $,a as H,c as L,b as O}from"./card-8r8oBd_e.js";import{u as R,d as b,I as M,B as j}from"./index-B2yiPlNq.js";import{S as v,e as w,f as T,g as D,h as a,d as Q,C as _,B as P,i as G,j as J,A as K,k as W,l as X,m as Y,n as Z,o as ee,p as se,q as ae,r as le}from"./TaskDialog-DECGOoM7.js";import{h as re,P as oe,i as ie,j as te}from"./vendor-date-charts-B43nfnO2.js";import"./vendor-DNP07iVI.js";import"./vendor-router-DyZlD0AS.js";import"./vendor-ui-extras-CuoCuRK-.js";import"./vendor-forms-B4oTGqCB.js";function xe(){const{user:i}=R(),[m,g]=l.useState([]),[t,V]=l.useState("all"),[n,U]=l.useState("all"),[f,C]=l.useState("all"),[d,S]=l.useState(""),[y,N]=l.useState(!0),[A,p]=l.useState(!1),[q,x]=l.useState(null),u=l.useRef(0),E=l.useCallback(()=>{const s=[];return t!=="all"&&s.push({field:"status",conditions:{eq:t}}),["completed","not done"].includes(t)||s.push({field:"completed",conditions:{eq:!1}}),n!=="all"&&s.push({field:"effort",conditions:{eq:n}}),f==="templates"?s.push({field:"isTemplate",conditions:{eq:!0}}):f==="non-templates"&&s.push({field:"isTemplate",conditions:{eq:!1}}),s},[t,n,f]),c=l.useCallback(async()=>{if(!i){g([]),N(!1);return}const s=++u.current;N(!0);const r=d.trim(),o=E(),h={limit:200,offset:0,sort:[{field:"orderIndex",direction:"asc"},{field:"createdAt",direction:"desc"}]};r&&(h.search=r),o.length>0&&(h.filters=o);try{const k=await b.tasks.query(h);u.current===s&&g(k.data||[])}catch(k){console.error("Error fetching tasks:",k),u.current===s&&g([])}finally{u.current===s&&N(!1)}},[i,d,E]);l.useEffect(()=>{c()},[c]);const F=async s=>{if(!i)return;const r=m.find(o=>o.id===s);if(r)try{await b.tasks.update(s,{completed:!r.completed}),await c()}catch(o){console.error("Error toggling task completion:",o)}},B=s=>{x(s),p(!0)},z=()=>{x(null),p(!0)},I=async s=>{if(i)try{await b.tasks.delete(s),await c()}catch(r){console.error("Error deleting task:",r)}};return i?e.jsxDEV("div",{className:"p-3 sm:p-4 lg:p-6",children:e.jsxDEV("div",{className:"max-w-4xl mx-auto",children:[e.jsxDEV("div",{className:"mb-4 sm:mb-6 lg:mb-8",children:[e.jsxDEV("h1",{className:"text-2xl sm:text-3xl font-bold",children:"All Tasks"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:180,columnNumber:11},this),e.jsxDEV("p",{className:"text-sm sm:text-base text-muted-foreground",children:"View and manage all tasks across all goals"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:181,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:179,columnNumber:9},this),e.jsxDEV("div",{className:"flex flex-col gap-3 sm:gap-4 mb-4 sm:mb-6",children:[e.jsxDEV("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-2",children:[e.jsxDEV("div",{className:"relative flex-1 min-w-0",children:[e.jsxDEV(re,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:189,columnNumber:15},this),e.jsxDEV(M,{placeholder:"Search tasks...",value:d,onChange:s=>S(s.target.value),className:"pl-10"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:190,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:188,columnNumber:13},this),e.jsxDEV("div",{className:"flex flex-wrap gap-2 sm:flex-nowrap",children:[e.jsxDEV(v,{value:t,onValueChange:V,children:[e.jsxDEV(w,{className:"w-full sm:w-[140px]",children:e.jsxDEV(T,{placeholder:"Status"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:200,columnNumber:19},this)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:199,columnNumber:17},this),e.jsxDEV(D,{children:[e.jsxDEV(a,{value:"all",children:"All Status"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:203,columnNumber:19},this),e.jsxDEV(a,{value:"todo",children:"To Do"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:204,columnNumber:19},this),e.jsxDEV(a,{value:"in progress",children:"In Progress"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:205,columnNumber:19},this),e.jsxDEV(a,{value:"blocked",children:"Blocked"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:206,columnNumber:19},this),e.jsxDEV(a,{value:"completed",children:"Completed"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:207,columnNumber:19},this),e.jsxDEV(a,{value:"not done",children:"Not Done"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:208,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:202,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:198,columnNumber:15},this),e.jsxDEV(v,{value:n,onValueChange:U,children:[e.jsxDEV(w,{className:"w-full sm:w-[120px]",children:e.jsxDEV(T,{placeholder:"Effort"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:213,columnNumber:19},this)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:212,columnNumber:17},this),e.jsxDEV(D,{children:[e.jsxDEV(a,{value:"all",children:"All Effort"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:216,columnNumber:19},this),e.jsxDEV(a,{value:"low",children:"Low"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:217,columnNumber:19},this),e.jsxDEV(a,{value:"med",children:"Medium"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:218,columnNumber:19},this),e.jsxDEV(a,{value:"high",children:"High"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:219,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:215,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:211,columnNumber:15},this),e.jsxDEV(v,{value:f,onValueChange:C,children:[e.jsxDEV(w,{className:"w-full sm:w-[140px]",children:e.jsxDEV(T,{placeholder:"Templates"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:224,columnNumber:19},this)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:223,columnNumber:17},this),e.jsxDEV(D,{children:[e.jsxDEV(a,{value:"all",children:"All Tasks"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:227,columnNumber:19},this),e.jsxDEV(a,{value:"templates",children:"Templates Only"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:228,columnNumber:19},this),e.jsxDEV(a,{value:"non-templates",children:"Non-Templates"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:229,columnNumber:19},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:226,columnNumber:17},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:222,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:197,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:187,columnNumber:11},this),e.jsxDEV(j,{onClick:z,className:"w-full sm:w-auto",size:"sm",children:[e.jsxDEV(oe,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:239,columnNumber:13},this),"Create Task"]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:234,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:186,columnNumber:9},this),e.jsxDEV(Q,{open:A,onOpenChange:p,task:q||void 0,onSaved:()=>{c(),p(!1),x(null)}},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:244,columnNumber:9},this),e.jsxDEV($,{children:[e.jsxDEV(H,{children:e.jsxDEV(L,{children:"Tasks"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:257,columnNumber:13},this)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:256,columnNumber:11},this),e.jsxDEV(O,{children:y&&m.length===0?e.jsxDEV("div",{className:"text-center py-8 text-muted-foreground",children:e.jsxDEV("p",{children:"Loading tasks..."},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:262,columnNumber:17},this)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:261,columnNumber:15},this):m.length>0?e.jsxDEV("div",{className:"space-y-3 sm:space-y-4",children:m.map(s=>e.jsxDEV("div",{className:"flex items-start gap-2 sm:gap-3 p-3 sm:p-4 border rounded-lg hover:bg-accent/50",children:[e.jsxDEV(_,{checked:s.completed||!1,onCheckedChange:()=>F(s.id),className:"mt-1 flex-shrink-0"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:271,columnNumber:21},this),e.jsxDEV("div",{className:"flex-1 min-w-0",children:[e.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-1",children:[e.jsxDEV("h3",{className:`font-medium break-words ${s.completed?"line-through text-muted-foreground":""} ${s.status==="not done"?"line-through text-red-500":""}`,children:s.title},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:278,columnNumber:25},this),e.jsxDEV("div",{className:"flex flex-wrap gap-1",children:[s.status&&e.jsxDEV(P,{className:`text-xs ${G(s.status)}`,children:s.status},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:293,columnNumber:29},this),s.effort&&e.jsxDEV(P,{className:`text-xs ${J(s.effort)}`,children:s.effort},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:302,columnNumber:29},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:291,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:277,columnNumber:23},this),s.description&&e.jsxDEV("div",{className:`mt-2 text-xs sm:text-sm ${s.completed?"text-muted-foreground":"text-foreground/70"}`,dangerouslySetInnerHTML:{__html:s.description}},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:313,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:276,columnNumber:21},this),e.jsxDEV("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsxDEV(j,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",title:"Edit task",onClick:()=>B(s),children:e.jsxDEV(ie,{size:16},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:331,columnNumber:25},this)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:324,columnNumber:23},this),e.jsxDEV(K,{children:[e.jsxDEV(W,{asChild:!0,children:e.jsxDEV(j,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-500 hover:text-red-700",title:"Delete task",children:e.jsxDEV(te,{size:16},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:341,columnNumber:29},this)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:335,columnNumber:27},this)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:334,columnNumber:25},this),e.jsxDEV(X,{children:[e.jsxDEV(Y,{children:[e.jsxDEV(Z,{children:"Delete Task"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:346,columnNumber:29},this),e.jsxDEV(ee,{children:['Are you sure you want to delete "',s.title,'"? This action cannot be undone.']},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:347,columnNumber:29},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:345,columnNumber:27},this),e.jsxDEV(se,{children:[e.jsxDEV(ae,{children:"Cancel"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:353,columnNumber:29},this),e.jsxDEV(le,{onClick:()=>I(s.id),className:"bg-red-600 hover:bg-red-700",children:"Delete"},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:354,columnNumber:29},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:352,columnNumber:27},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:344,columnNumber:25},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:333,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:323,columnNumber:21},this)]},s.id,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:267,columnNumber:19},this))},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:265,columnNumber:15},this):e.jsxDEV("div",{className:"text-center py-8 text-muted-foreground",children:e.jsxDEV("p",{children:"No tasks found."},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:369,columnNumber:17},this)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:368,columnNumber:15},this)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:259,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:255,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:178,columnNumber:7},this)},void 0,!1,{fileName:"/Users/ali/projects/self-flow-monorepo/packages/fe/src/pages/TasksPage.tsx",lineNumber:177,columnNumber:5},this):null}export{xe as default};
